/*
 * ZAVZ Hacked Client
 */
package net.ccbluex.liquidbounce.features.module.modules.exploit;

import net.ccbluex.liquidbounce.event.Listener;
import net.ccbluex.liquidbounce.event.PackeetEvent;
import net.ccbluex.liquidbounce.features.module.Module;
import net.ccbluex.liquidbounce.features.module.ModuleCategory;
import net.ccbluex.liquidbounce.features.module.ModuleInfo;
import net.minecraft.network.play.server.S27PacketExplosion;
import net.minecraft.network.play.server.S2APacketParticles;
import net.minecraft.network.play.server.S08PacketPlayerPosLook;
import net.minecraft.network.play.server.S0FPacketSpawnMob;

@ModuleInfo(name = "AntiCrasher", category = ModuleCategory.EXPLOIT)
public class AntiCrasher extends Module {
    private final Listener<PackeetEvent> packetEventListener;

    public AntiCrasher() {
        final S08PacketPlayerPosLook[] s08 = new S08PacketPlayerPosLook[1];
        final S2APacketParticles[] s2a = new S2APacketParticles[1];
        final S27PacketExplosion[] s9 = new S27PacketExplosion[1];
        this.packetEventListener = (e -> {
            if (e.getState() == PackeetEvent.State.RECEIVE) {
                if (this.mc.thePlayer != null && this.mc.theWorld != null) {
                    if (e.getPacket() instanceof S0FPacketSpawnMob && this.mc.theWorld.loadedEntityList.size() > 500) {
                        e.setCancelled(true);
                    }
                    if (e.getPacket() instanceof S08PacketPlayerPosLook) {
                        s08[0] = (S08PacketPlayerPosLook)e.getPacket();
                        if (s08[0].getYaw() > 380.0f || s08[0].getYaw() < -380.0f || s08[0].getPitch() < -90.0f || s08[0].getPitch() > 90.0f) {
                            e.setCancelled(true);
                        }
                        if (s08[0].getX() > 2.0E7 || s08[0].getY() > 2.0E7 || s08[0].getZ() > 2.0E7 || s08[0].getX() < -2.0E7 || s08[0].getY() < -2.0E7 || s08[0].getZ() < -2.0E7) {
                            e.setCancelled(true);
                        }
                    }
                    if (e.getPacket() instanceof S2APacketParticles) {
                        s2a[0] = (S2APacketParticles)e.getPacket();
                        if (s2a[0].getParticleCount() > 1024) {
                            e.setCancelled(true);
                        }
                    }
                    if (e.getPacket() instanceof S27PacketExplosion) {
                        s9[0] = (S27PacketExplosion)e.getPacket();
                        if (s9[0].func_149144_d() > 10000.0f || s9[0].func_149147_e() > 10000.0f || s9[0].func_149149_c() > 10000.0f || s9[0].getX() > 10000.0 || s9[0].getY() > 10000.0 || s9[0].getZ() > 10000.0) {
                            e.setCancelled(true);
                        }
                    }
                }
            }
        });
    }
}
